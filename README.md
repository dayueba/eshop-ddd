# ç”µå­å•†åŸDDDé¡¹ç›®

åŸºäºé¢†åŸŸé©±åŠ¨è®¾è®¡(DDD)æ€æƒ³ï¼Œä½¿ç”¨Express + TypeScriptå®ç°çš„ç”µå­å•†åŸç³»ç»Ÿã€‚

## ğŸ¯ é¡¹ç›®ç‰¹æ€§

- ğŸ—ï¸ **DDDæ¶æ„**: é‡‡ç”¨é¢†åŸŸé©±åŠ¨è®¾è®¡æ€æƒ³ï¼Œæ¸…æ™°çš„æœ‰ç•Œä¸Šä¸‹æ–‡åˆ’åˆ†
- ğŸ”„ **ä¾èµ–æ³¨å…¥**: ä½¿ç”¨Inversifyå®ç°IoCå®¹å™¨ï¼Œæ¾è€¦åˆæ¶æ„
- ğŸ›’ **è´­ç‰©è½¦ç³»ç»Ÿ**: å®Œæ•´çš„è´­ç‰©è½¦ç®¡ç†åŠŸèƒ½
- ğŸ” **JWTè®¤è¯**: åŸºäºJWTçš„ç”¨æˆ·è®¤è¯å’Œæˆæƒç³»ç»Ÿ
- ğŸ“ **è¾“å…¥éªŒè¯**: ä½¿ç”¨Joiè¿›è¡Œä¸¥æ ¼çš„è¾“å…¥éªŒè¯
- ğŸ“š **APIæ–‡æ¡£**: é›†æˆSwaggerè‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£
- ğŸ›¡ï¸ **å®‰å…¨é˜²æŠ¤**: é›†æˆHelmetã€CORSã€é™æµç­‰å®‰å…¨ä¸­é—´ä»¶
- ğŸ“Š **æ•°æ®åº“**: MongoDB + Mongoose ODM
- ğŸ§ª **æµ‹è¯•æ”¯æŒ**: Jest + Supertestæµ‹è¯•æ¡†æ¶
- ğŸ¯ **TypeScript**: å®Œæ•´çš„TypeScriptç±»å‹æ”¯æŒ

## ğŸ“‹ åŠŸèƒ½çŠ¶æ€

### âœ… å·²å®Œæˆæ¨¡å—
- **ç”¨æˆ·ç®¡ç†**: æ³¨å†Œã€ç™»å½•ã€è®¤è¯ (100%)
- **è´­ç‰©è½¦**: æ·»åŠ å•†å“ã€ç§»é™¤å•†å“ã€æŸ¥çœ‹è´­ç‰©è½¦ (95%)
- **ç³»ç»Ÿé›†æˆ**: ä¾èµ–æ³¨å…¥ã€æ•°æ®åº“è¿æ¥ã€é”™è¯¯å¤„ç† (100%)

### ğŸ”„ è¿›è¡Œä¸­
- **å•†å“ç®¡ç†**: é¢†åŸŸå±‚å®Œæˆï¼Œåº”ç”¨å±‚å®ç°ä¸­ (60%)
- **è®¢å•ç®¡ç†**: é¢†åŸŸå±‚å®Œæˆï¼Œåº”ç”¨å±‚å¾…å®ç° (40%)

### ğŸ“… è®¡åˆ’ä¸­
- **æ”¯ä»˜ç³»ç»Ÿ**: æ”¯ä»˜æµç¨‹å¤„ç†
- **ç‰©æµç®¡ç†**: å‘è´§çŠ¶æ€è·Ÿè¸ª
- **å•†å“æœç´¢**: æœç´¢å’Œç­›é€‰åŠŸèƒ½

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ shared/                 # å…±äº«å†…æ ¸
â”‚   â”œâ”€â”€ domain/            # é¢†åŸŸå±‚åŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ infrastructure/    # åŸºç¡€è®¾æ–½å±‚ç»„ä»¶
â”‚   â””â”€â”€ application/       # åº”ç”¨å±‚åŸºç¡€ç»„ä»¶
â”œâ”€â”€ contexts/              # æœ‰ç•Œä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ user/             # ç”¨æˆ·ä¸Šä¸‹æ–‡ âœ…
â”‚   â”œâ”€â”€ cart/             # è´­ç‰©è½¦ä¸Šä¸‹æ–‡ âœ…
â”‚   â”œâ”€â”€ product/          # å•†å“ä¸Šä¸‹æ–‡ ğŸ”„
â”‚   â””â”€â”€ order/            # è®¢å•ä¸Šä¸‹æ–‡ ğŸ”„
â”œâ”€â”€ api/                   # APIå±‚
â”‚   â”œâ”€â”€ controllers/      # æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ middleware/       # ä¸­é—´ä»¶
â”‚   â””â”€â”€ routes/           # è·¯ç”±
â”œâ”€â”€ config/               # é…ç½®
â”‚   â”œâ”€â”€ container.ts      # ä¾èµ–æ³¨å…¥å®¹å™¨ âœ…
â”‚   â”œâ”€â”€ database.ts       # æ•°æ®åº“è¿æ¥ âœ…
â”‚   â””â”€â”€ environment.ts    # ç¯å¢ƒé…ç½®
â””â”€â”€ server.ts             # æœåŠ¡å™¨å…¥å£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 18+
- MongoDB 4.4+
- npm æˆ– yarn

### å®‰è£…ä¾èµ–

```bash
npm install
```

### ç¯å¢ƒé…ç½®

1. å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶ï¼š
```bash
cp env.example .env
```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ç­‰ä¿¡æ¯ï¼š
```env
PORT=3000
NODE_ENV=development
MONGODB_URI=mongodb://localhost:27017/eshop-ddd
JWT_SECRET=your-super-secret-jwt-key
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

æœåŠ¡å™¨å°†åœ¨ http://localhost:3000 å¯åŠ¨

**é¢„æœŸè¾“å‡º**:
```
ğŸš€ æ­£åœ¨å¯åŠ¨ç”µå­å•†åŸæœåŠ¡å™¨...
ğŸ“Š æ­£åœ¨è¿æ¥æ•°æ®åº“...
âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ

ğŸ‰ æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“ æœåŠ¡åœ°å€: http://localhost:3000
ğŸ“š APIæ–‡æ¡£: http://localhost:3000/api-docs
ğŸŒ è¿è¡Œç¯å¢ƒ: development
ğŸ’¾ æ•°æ®åº“: âœ… å·²è¿æ¥

ğŸ› ï¸  å¯ç”¨çš„APIç«¯ç‚¹:
   POST /api/users/register - ç”¨æˆ·æ³¨å†Œ
   POST /api/users/login - ç”¨æˆ·ç™»å½•
   GET  /api/cart - è·å–è´­ç‰©è½¦
   POST /api/cart/items - æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

### APIæ–‡æ¡£

å¯åŠ¨æœåŠ¡å™¨åï¼Œè®¿é—® http://localhost:3000/api-docs æŸ¥çœ‹å®Œæ•´çš„APIæ–‡æ¡£

## ğŸ› ï¸ å¯ç”¨è„šæœ¬

- `npm run dev` - å¯åŠ¨å¼€å‘æœåŠ¡å™¨
- `npm run build` - æ„å»ºç”Ÿäº§ç‰ˆæœ¬
- `npm start` - å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
- `npm test` - è¿è¡Œæµ‹è¯•
- `npm run test:watch` - ç›‘è§†æ¨¡å¼è¿è¡Œæµ‹è¯•
- `npm run test:coverage` - ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
- `npm run lint` - ä»£ç æ£€æŸ¥
- `npm run lint:fix` - è‡ªåŠ¨ä¿®å¤ä»£ç é—®é¢˜
- `npm run format` - ä»£ç æ ¼å¼åŒ–

## ğŸ”Œ APIç«¯ç‚¹

### ç”¨æˆ·ç®¡ç†
- `POST /api/users/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/users/login` - ç”¨æˆ·ç™»å½•
- `GET /api/users/profile` - è·å–ç”¨æˆ·ä¿¡æ¯

### è´­ç‰©è½¦ç®¡ç† ğŸ›’
- `GET /api/cart` - è·å–ç”¨æˆ·è´­ç‰©è½¦
- `POST /api/cart/items` - æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
- `DELETE /api/cart/items/:productId` - ç§»é™¤è´­ç‰©è½¦å•†å“
- `PUT /api/cart/items/:productId/quantity` - æ›´æ–°å•†å“æ•°é‡
- `DELETE /api/cart/clear` - æ¸…ç©ºè´­ç‰©è½¦

### ç³»ç»Ÿç›‘æ§
- `GET /health` - å¥åº·æ£€æŸ¥ï¼ˆåŒ…å«æ•°æ®åº“çŠ¶æ€ï¼‰
- `GET /` - APIä¿¡æ¯

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç”¨æˆ·æ³¨å†Œ

```bash
curl -X POST http://localhost:3000/api/users/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "SecurePass123!",
    "firstName": "å¼ ",
    "lastName": "ä¸‰"
  }'
```

### ç”¨æˆ·ç™»å½•

```bash
curl -X POST http://localhost:3000/api/users/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "SecurePass123!"
  }'
```

### æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦

```bash
curl -X POST http://localhost:3000/api/cart/items \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "productId": "product-123",
    "productName": "ç¤ºä¾‹å•†å“",
    "price": 99.99,
    "currency": "CNY", 
    "quantity": 2
  }'
```

### è·å–è´­ç‰©è½¦

```bash
curl -X GET http://localhost:3000/api/cart \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

## ğŸ›ï¸ æ¶æ„è®¾è®¡

### é¢†åŸŸé©±åŠ¨è®¾è®¡(DDD)

é¡¹ç›®é‡‡ç”¨DDDè®¾è®¡ï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒæ¦‚å¿µï¼š

- **å®ä½“(Entity)**: å…·æœ‰å”¯ä¸€æ ‡è¯†çš„é¢†åŸŸå¯¹è±¡
- **å€¼å¯¹è±¡(Value Object)**: ä¸å¯å˜çš„å€¼ç±»å‹
- **èšåˆæ ¹(Aggregate Root)**: èšåˆçš„å…¥å£ç‚¹
- **ä»“å‚¨(Repository)**: æ•°æ®æŒä¹…åŒ–æŠ½è±¡
- **é¢†åŸŸäº‹ä»¶(Domain Event)**: é¢†åŸŸä¸­å‘ç”Ÿçš„é‡è¦äº‹ä»¶
- **åº”ç”¨æœåŠ¡(Application Service)**: ç¼–æ’é¢†åŸŸå¯¹è±¡å®Œæˆä¸šåŠ¡ç”¨ä¾‹

### CQRSæ¨¡å¼

ä½¿ç”¨å‘½ä»¤æŸ¥è¯¢èŒè´£åˆ†ç¦»æ¨¡å¼ï¼š
- **å‘½ä»¤(Command)**: å¤„ç†å†™æ“ä½œ
- **æŸ¥è¯¢(Query)**: å¤„ç†è¯»æ“ä½œ

### ä¾èµ–æ³¨å…¥æ¨¡å¼

ä½¿ç”¨Inversify IoCå®¹å™¨å®ç°ï¼š
- **æ¥å£é©±åŠ¨**: ä¾èµ–äºæŠ½è±¡è€Œéå…·ä½“å®ç°
- **æ„é€ å‡½æ•°æ³¨å…¥**: é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ä¾èµ–
- **ç”Ÿå‘½å‘¨æœŸç®¡ç†**: å•ä¾‹ã€ç¬æ€ç­‰ä¸åŒç”Ÿå‘½å‘¨æœŸ
- **ç±»å‹å®‰å…¨**: TypeScriptè£…é¥°å™¨æ”¯æŒ

## ğŸ§ª æµ‹è¯•

è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼š
```bash
npm test
```

è¿è¡Œç‰¹å®šæµ‹è¯•ï¼š
```bash
npm test -- --testNamePattern="User"
```

ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡ï¼š
```bash
npm run test:coverage
```

## ğŸš€ éƒ¨ç½²

### æ„å»ºé¡¹ç›®

```bash
npm run build
```

### å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨

```bash
npm start
```

### Dockeréƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t eshop-ddd .

# è¿è¡Œå®¹å™¨
docker run -p 3000:3000 -e MONGODB_URI=your_mongo_uri eshop-ddd
```

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### ğŸ“– è®¾è®¡æ–‡æ¡£
- [é¡¹ç›®è®¾è®¡æ–‡æ¡£](doc/é¡¹ç›®è®¾è®¡æ–‡æ¡£.md) - å®Œæ•´çš„æŠ€æœ¯æ¶æ„è®¾è®¡
- [åˆ†æ­¥å®ç°æ–‡æ¡£](doc/åˆ†æ­¥å®ç°æ–‡æ¡£.md) - 12ä¸ªé˜¶æ®µçš„è¯¦ç»†å®æ–½è®¡åˆ’
- [å•†å“æ¨¡å—è®¾è®¡æ–‡æ¡£](doc/å•†å“æ¨¡å—è®¾è®¡æ–‡æ¡£.md) - å•†å“æ¨¡å—è¯¦ç»†è®¾è®¡
- [è®¢å•æ¨¡å—è®¾è®¡æ–‡æ¡£](doc/è®¢å•æ¨¡å—è®¾è®¡æ–‡æ¡£.md) - è®¢å•æ¨¡å—è¯¦ç»†è®¾è®¡

### ğŸ“‹ è¿›åº¦æ–‡æ¡£
- [ç³»ç»Ÿé›†æˆå®ŒæˆçŠ¶æ€](doc/ç³»ç»Ÿé›†æˆå®ŒæˆçŠ¶æ€.md) - å½“å‰é›†æˆçŠ¶æ€å’ŒåŠŸèƒ½æ¼”ç¤º
- [é¡¹ç›®å®ç°çŠ¶æ€æ€»ç»“](doc/é¡¹ç›®å®ç°çŠ¶æ€æ€»ç»“.md) - å„æ¨¡å—å®Œæˆåº¦ç»Ÿè®¡

### ğŸ”§ å¼€å‘æŒ‡å—
- [å¼€å‘è§„èŒƒ](.cursor/rules/development-guidelines.mdc) - ä»£ç è§„èŒƒå’Œæœ€ä½³å®è·µ
- [APIå¼€å‘æ¨¡å¼](.cursor/rules/api-patterns.mdc) - APIè®¾è®¡æ¨¡å¼
- [æµ‹è¯•æŒ‡å—](.cursor/rules/testing-guidelines.mdc) - æµ‹è¯•ç­–ç•¥å’Œè§„èŒƒ

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“ è®¸å¯è¯

MIT License - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ“ è”ç³»æ–¹å¼

é¡¹ç›®é“¾æ¥: [https://github.com/yourusername/eshop-ddd](https://github.com/yourusername/eshop-ddd)

---

âš¡ **ç³»ç»Ÿå½“å‰çŠ¶æ€**: å¯ç”¨äºå¼€å‘å’Œæµ‹è¯•ï¼Œç”¨æˆ·è®¤è¯å’Œè´­ç‰©è½¦åŠŸèƒ½å®Œæ•´å¯ç”¨ 